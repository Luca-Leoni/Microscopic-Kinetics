\section{Diffusion equation and atomic models}

We have already discussed how diffusion can be model on a macroscopical base using non equilibrium thermodynamics obtaining interesting result both for the forms of the fluxes and of the diffusion constant. Now, we want to look at a more microscopic level trying first to describe how we can understand the motions of atoms looking at their density $c(\vb{x}, t)$ inside the material.

We have seen in the previous section how the flux of particles $\vb{J}$ can be described by using the density of atoms inside the material via Fick's first law, \eqref{eq:FickLaw}. Still, we can also try to describe the density of atoms inside the system, in fact the function $c$ describing the number of atoms inside the material will need to respect some continuity condition such as \eqref{eq:ContEquEntropy}. These two conditions taken together allow us to obtain a really powerful tool in order to study the evolution of density inside materials.
\thm{Second Fick's law}
{
    Inside a multicomponent material the density $c_i(\vb{x}, t)$ of the $i$-th component respect the following differential equation
    \begin{equation}
        \label{eq:SecFickLaw}
        \pdv{c_i}{t} = D_i \laplacian c_i.
    \end{equation}
}
\pf{Proof}
{
    We can write down the continuity equation for the densities assuming that source or sink terms $\dot{n}_i$ are negligible, since the vast majority of the time this is the case, so that we have
    \begin{equation}
        \pdv{c_i}{t} = -\grad\vdot\vb{J}_i = \grad\vdot\left( D_i\grad c_i \right).
    \end{equation}
    In general $D_i$ should be a tensor, still we are going to think at it as a simple scalar which in general can be assumed to depend on position through the density, as $D_i(c_i)$. Meaning that the diffusivity can be expanded using Taylor as
    \begin{equation}
        D_i \approx D(\left\langle c_i \right\rangle) + \left( c_i - \left\langle c_i \right\rangle \right)\eval{\pdv{D_i}{c_i}}_{\left\langle c_i \right\rangle},
    \end{equation}
    where $\left\langle c_i \right\rangle$ is the average value of the density inside the material and was chosen as the expansion point for simplicity. Inserting that expansion inside the continuity equation we get
    \begin{equation}
        \grad\vdot\left( D_i\grad c_i \right) = D(\left\langle c_i \right\rangle)\laplacian c_i + \eval{\pdv{D_i}{c_i}}_{\left\langle c_i \right\rangle} \left( \laplacian c_i + \grad c_i \vdot \grad c_i \right),
    \end{equation}
    but the second term is often neglected since the diffusivity has a general low dependence on the density, obtaining the wanted result.
}

\noindent
This equation allow us to describe the density of atoms inside the material in every moment in time given some initial conditions. To make an example, in 1D it's easy to see how if you take as a boundary condition for the density $c_i (x, t\to 0) = n_i\delta(x)$ than the following function is the solution
\begin{equation}
    c_i(x, t) = \frac{n_i}{\sqrt{4\pi D_it}}e^{-\frac{x^2}{4D_it}}.
\end{equation}
Where $n_i$ is the total number of atoms so that $c_i$ will be the number of atoms divided by a lenght, and one can easily see how that expression satisfy both the partial differential equation and the boundary conditions. From it, we can see how the atoms will start centered in the  origin and then will start to spread from it inside the material. In particular one can see how the average displacement of the atoms will be equal to the spread of the Gaussian itself $\sigma$ which can be easily computed using the known formula
\begin{align}
    \label{eq:Displ1D}
    &G(\mu, \sigma) = \frac{C}{\sqrt{2\pi\sigma}}e^{-\frac{(x - \mu)^2}{2\sigma^2}}, &\sigma = \sqrt{2D_it}.
\end{align}
Meaning that the average displacement will be proportional to $\sqrt{t}$, which is typical for diffusion phenomena showing how the process is slow needing much more time to spread the atoms as the dimensions of the system increase.

This result is general also when we look at higher dimensions, since it's possible to see that the same boundary condition and solution can be used even in 2D or 3D so that the solution is a simple product of the 1D one
\begin{equation}
    c_i(\vb{r}, t) = \frac{n_i}{\left( 4\pi D_it \right)^{d/2}}e^{-\frac{\vb{r}^2}{4D_it}}.
\end{equation}
Where $d$ is the dimensionality of the system, and we can see how the Dirac delta form for $t \to 0$ is still respected along with the differential equation. Also, the form of the average displacement is closer to the naive 1D case, but we can find out a more general form by evaluating it explicitly as
\begin{equation}
    \label{eq:DiffEquaModel}
    \left\langle R^2(t) \right\rangle = \frac{\int_{\mathbb{R}^+}\int_{\Omega}r^2c(r, t) r^2\dd \Omega\dd r}{\int_{\mathbb{R}^+}\int_{\Omega}c(r, t) r^2\dd \Omega\dd r} = 2dD_it,
\end{equation}
which is consistent with \eqref{eq:Displ1D}. This result is telling us that doesn't matter the dimension, the evolution of the displacement in a diffusive process only depend on the nature of the process itself and scales in time as $\sqrt{t}$, usually slow.

Therefore, using these results we were able to already describe some interesting properties of the diffusion process in a material having some important quantitative results. Still, this is only the beginning this model can be highly refined by using several considerations that will allow for it to be of great precision.

\nt
{
    The Gaussian form of the solution is interesting not only for the description of the evolution in time itself, but also on an experimental point of view. In fact, if one is able to evaluate $c(x, t)$ as function of position and time can see how
    \begin{equation}
        \ln c_i = const. - \frac{x^2}{4D_it},
    \end{equation}
    meaning that by making a linear fit in a $ln c_i$ vs $x^2$ plot at a certain time will allow us to estimate $D_i$ experimentally.
}

\subsection{Diffusion and random walk}

Another way to approach the modelling of diffusion is describing it using the mathematical model of the \textbf{random walk}. We can consider the atom moving by performing a series of possible jumps in space defined by the vectors $\{\vb{r}_i\}$, where every jump can be done with a frequency $\Gamma$. This means that after a certain time $t$ the number of jumps performed would be $\mean{N_{t}} = \Gamma t$ and the distance travelled by the atom would be
\begin{align}
    &\vb{R}(t) = \sum_{i=1}^{\Gamma t} \vb{r}_i, &R^2(t) = \sum_{i=1}^{\Gamma t} r_i^2 + 2\sum_{i=1}^{\Gamma t - 1} \sum_{j=1}^{\Gamma t - i} \vb{r}_i \vdot \vb{r}_{i+j}.
\end{align}
Where also the square of the displacement was reported since our aim is to evaluate the mean square displacement of the average walker inside the diffusion process and confront it with the previous model. Therefore, by taking the average of $R^2$ it's possible to see how it's value will take the form of
\begin{equation}
    \label{eq:RandWalkMod}
    \mean{R^2(t)} = \Gamma t\mean{r^2} + 2\mean{\sum_{i=1}^{\Gamma t - 1} \sum_{j=1}^{\Gamma t - i} \vb{r}_i \vdot \vb{r}_{i+j}} = \Gamma t\mean{r^2} + 2\Pi(t),
\end{equation}
where $\Pi$ is the time correlation function between the jumps, describing how much the jumps influence one another. Now, in the case of a pure random walk, the jumps are totally uncorrelated with a uniform probability of going in every possible direction. Meaning that $\Pi = 0$ and average displacement takes a form analogous to the one already seen
\begin{align}
    &\mean{R^2(t)} = \Gamma t\mean{r^2},
\end{align}
showing how the evolution is still proportional to $t^{1/2}$ as expected from diffusion.

We can now confront the model just obtained, \eqref{eq:RandWalkMod}, and the more macroscopic description given by the solution of the diffusion equation, in \eqref{eq:DiffEquaModel}, and see how we can retain a form for the diffusivity.
\thm{Microscopic diffusivity}
{
    Inside an atomistic model the diffusion can be though as a random walk with frequency of jump $\Gamma$, so that macroscopically the density can be described using FIck's law with a diffusivity given by the microscopic properties as follows 
    \begin{align}
        &D = \frac{\Gamma\mean{r^2}f}{2d}, &f = 1 + \frac{2\Pi(t)}{\Gamma t\mean{r^2}},
    \end{align}
    where $\Pi(t)$ is the time correlation function for the jumps.
}
\pf{Proof}
{
    At first, we can see how \eqref{eq:RandWalkMod} can be recast in a simpler form analogous to the one in \eqref{eq:DiffEquaModel} by using
    \begin{align}
        &\mean{R^2(t)} = \Gamma t\mean{r^2}f, &f = 1 + \frac{2\Pi(t)}{\Gamma t\mean{r^2}}.
    \end{align}
    Which can be confronted with the mean square displacement of the macroscopic diffusion model to see that
    \begin{equation}
        D = \frac{\Gamma\mean{r^2}f}{2d},
    \end{equation}
    having our final result.
}
\noindent
Therefore, by simple consideration on the microscopic nature of the diffusion mechanism we were able to connect the diffusivity to the rate of jump inside the lattice. All we have to do now is describe how such rate can be expressed quantitatively, and then the whole model would be complete.

\subsection{Thermally activated jumps}

